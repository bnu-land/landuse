<!-- oscar999  -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>

<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="author" content="oscar999">
    <script type="text/javascript" src="../jquery/1.9.1/jquery.js"></script>
     <script src="../jquery/1.9.1/jquery.min.js"></script>
    <title></title>
    <script>
     var docObj = document.getElementById("doc");
     var docUrl=null;
    function handleFiles(files) {
        if (files.length) {
            var file = files[0];
            var reader = new FileReader();
            reader.onload = function() {
                document.getElementById("filecontent").innerHTML = this.result;
            };
            reader.readAsText(file);
        }
    }

    function readFile(filename) {

       // docUrl=window.URL.createObjectURL(docObj.files[0]);
     
        var fso = new ActiveXObject("Scripting.FileSystemObject");
        var f = fso.OpenTextFile(filename, 1);
        var s = "";s
        while (!f.AtEndOfStream)
            s += f.ReadLine() + "\n";
        f.Close();
        return s;
    }
    //写文件
    function writeFile(filename, filecontent) {
        var fso, f, s;
        fso = new ActiveXObject("Scripting.FileSystemObject");
        f = fso.OpenTextFile(filename, 8, true);
        f.WriteLine(filecontent);
        f.Close();
        alert('ok');
    }
    </script>
</head>

<body>
    <input type="file" id="file" onchange="handleFiles(this.files)" />
    <div id="filecontent"></div>
    <input type="file" id="doc" onchange="readFile(docUrl);"/>
    <input type="text" id="in" name="in" />
    <input type="button" value="Write!" onclick="writeFile('F:/Appserv/www/12.txt',document.getElementByIdx_x('in').value);" />
    <br>
    <br>
    <input type="button" value="Read!" onclick="document.getElementById('show').value=readFile('D:/地物编码表.txt');" />
    <br>
    <textarea id="show" name="show" cols="100" rows="20">
    </textarea>
</body>

</html>
