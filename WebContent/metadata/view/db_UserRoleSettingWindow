{
    "type": "Ext.window.Window",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "designer|userAlias": "db_UserRoleSettingWindow",
        "designer|userClassName": "db_UserRoleSettingWindow",
        "height": 283,
        "id": "db_UserRoleSettingWindow",
        "layout": "fit",
        "title": "用户角色设置",
        "width": 467
    },
    "designerId": "48f6f06e-19a8-4c37-9254-9d29fd36773d",
    "viewControllerInstanceId": "43e0ed1f-693e-413a-8ce9-cc614be9a3c6",
    "viewModelInstanceId": "134b0c1b-cf7f-4a9b-b87e-8ac737ef78a0",
    "cn": [
        {
            "type": "Ext.grid.Panel",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "id": "db_UserRoleSettingWindowForm",
                "store": "uRoleInfoStore",
                "title": null
            },
            "name": "MyGridPanel2",
            "designerId": "a46f2bea-2f66-4fc1-9275-536fd5c210ca",
            "cn": [
                {
                    "type": "Ext.grid.column.RowNumberer",
                    "reference": {
                        "name": "columns",
                        "type": "array"
                    },
                    "codeClass": null,
                    "name": "MyRowNumberer2",
                    "designerId": "54fa33ec-b60d-4d9d-996f-c6819dc250ff"
                },
                {
                    "type": "Ext.grid.column.Column",
                    "reference": {
                        "name": "columns",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "dataIndex": "roleNameCn",
                        "designer|displayName": null,
                        "id": "urSet_roleNameCn",
                        "text": "角色名称",
                        "width": 100
                    },
                    "name": "MyColumn5",
                    "designerId": "448c795b-b5f7-45fc-a4d9-adab22d04f76"
                },
                {
                    "type": "Ext.grid.column.Column",
                    "reference": {
                        "name": "columns",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "dataIndex": "roleName",
                        "id": "urSet_roleName",
                        "text": "角色代码",
                        "width": 100
                    },
                    "name": "MyColumn6",
                    "designerId": "4ecdfdd6-20b8-4965-bbd6-5710da5244dc"
                },
                {
                    "type": "Ext.grid.column.Column",
                    "reference": {
                        "name": "columns",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "dataIndex": "description",
                        "id": "urSet_description",
                        "text": "角色说明",
                        "width": 200
                    },
                    "name": "MyColumn7",
                    "designerId": "e83d7cb0-4fb3-4068-9f2c-1d3d0071e802"
                },
                {
                    "type": "Ext.grid.View",
                    "reference": {
                        "name": "viewConfig",
                        "type": "object"
                    },
                    "codeClass": null,
                    "name": "MyGridView2",
                    "designerId": "ba7b805b-e162-4f63-99f4-4138b8763a6a"
                },
                {
                    "type": "Ext.toolbar.Toolbar",
                    "reference": {
                        "name": "dockedItems",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "dock": "bottom"
                    },
                    "name": "MyToolbar2",
                    "designerId": "1b6e48ce-e8ac-419d-bf6a-76f0b5220782",
                    "cn": [
                        {
                            "type": "Ext.toolbar.Fill",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "layout|flex": null
                            },
                            "name": "MyFill2",
                            "designerId": "d7d06b86-5255-48bd-8c91-760f39ef4434"
                        },
                        {
                            "type": "Ext.form.field.Text",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "fieldLabel": "Label",
                                "id": "db_userRoleSettingUserNameLbl",
                                "layout|flex": null
                            },
                            "name": "MyTextField1",
                            "designerId": "ecb2a800-9eef-4a16-9bc1-d20f1d84ddad"
                        },
                        {
                            "type": "Ext.button.Button",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "layout|flex": null,
                                "text": "取消"
                            },
                            "name": "MyButton8",
                            "designerId": "b12b8274-15ed-4f19-9939-3344dabf7b9c",
                            "cn": [
                                {
                                    "type": "basicfunction",
                                    "reference": {
                                        "name": "items",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "fn": "handler",
                                        "implHandler": [
                                            "var win = Ext.getCmp('db_UserRoleSettingWindow');",
                                            "win.close();"
                                        ]
                                    },
                                    "name": "handler",
                                    "designerId": "18c1d498-939b-446b-ba8c-0ea47daacc52"
                                }
                            ]
                        },
                        {
                            "type": "Ext.toolbar.Spacer",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "layout|flex": null,
                                "width": 10
                            },
                            "name": "MySpacer2",
                            "designerId": "cc7d022f-f9fd-44fc-8193-dcb2c87e69ac"
                        },
                        {
                            "type": "Ext.button.Button",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "layout|flex": null,
                                "text": "确定"
                            },
                            "name": "MyButton9",
                            "designerId": "77b5d64e-3da5-44ee-9e39-6d2efebef7e8",
                            "cn": [
                                {
                                    "type": "basiceventbinding",
                                    "reference": {
                                        "name": "listeners",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "fn": "onButtonClick",
                                        "implHandler": [
                                            "var win = Ext.getCmp('db_UserRoleSettingWindow');",
                                            "",
                                            "",
                                            "var grid = Ext.getCmp('db_UserRoleSettingWindowForm');",
                                            "var records = grid.getSelection();",
                                            "if (records.length === 0) {",
                                            "    Ext.Msg.alert('提示', '请选择一个用户角色。');",
                                            "    return;",
                                            "} else if (records.length > 1) {",
                                            "    Ext.Msg.alert('提示', '每个用户只有一个角色。');",
                                            "    return;",
                                            "}",
                                            "var record = records[0];",
                                            "",
                                            "var userName= Ext.getCmp('db_userRoleSettingUserNameLbl').getValue();",
                                            "var roleId = record.get('roleId');",
                                            "Ext.Msg.confirm('您正在设置', '用户：' + userName + '为：'+record.get('roleNameCn')+'角色，<br/> 确认设置？', getResult);",
                                            "function getResult(confirm)",
                                            "{",
                                            "    if (confirm == \"yes\"){",
                                            "        Ext.Ajax.request(",
                                            "        {",
                                            "            url : 'update_UserRole',",
                                            "            params :",
                                            "            {",
                                            "                username : userName,",
                                            "                roleid : roleId",
                                            "            },",
                                            "            success : function (response){",
                                            "                Ext.Msg.alert('成功提示', '角色设置成功。');",
                                            "                var mystore = Ext.StoreMgr.get('uUserRoleStore');",
                                            "                mystore.load();",
                                            "                win.close();",
                                            "            },",
                                            "            failure : function (response){",
                                            "            }",
                                            "        });",
                                            "    }",
                                            "}"
                                        ],
                                        "name": "click",
                                        "scope": "me"
                                    },
                                    "name": "onButtonClick",
                                    "designerId": "b7723fb1-298a-4e68-9d27-6b5b0d50de4b"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "Ext.selection.CheckboxModel",
                    "reference": {
                        "name": "selModel",
                        "type": "object"
                    },
                    "codeClass": "Ext.selection.CheckboxModel",
                    "name": "MyCheckboxSelectionModel1",
                    "designerId": "ba3b459f-f449-4ee7-83ff-5fb748c5ed9b"
                }
            ]
        }
    ]
}